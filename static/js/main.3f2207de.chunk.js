(window["webpackJsonpbeyond-toy"]=window["webpackJsonpbeyond-toy"]||[]).push([[0],{36:function(e,t,n){},63:function(e,t,n){e.exports=n(86)},80:function(e,t){},81:function(e,t){},82:function(e,t){},83:function(e,t){},84:function(e,t){},85:function(e,t){},86:function(e,t,n){"use strict";n.r(t);var a=n(23),r=n(24),o=n(29),c=n(25),i=n(30),l=n(1),s=n.n(l),u=n(9),d=n.n(u),f=(n(36),n(46)),p=n(33),m=n(114),v=n(121),b=n(122),h=n(41),y=n(124),E=n(123),g=n(55),j=n.n(g),O=n(127),w=n(115),x=n(117),k=n(118),P=n(119),R=n(53),S=n.n(R),C=n(54),I=n.n(C);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var F=Object(m.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function N(){var e,t=F(),n=s.a.useState({top:!1,link:"11111"}),a=Object(p.a)(n,2),r=a[0],o=a[1],c=function(e,t){return function(n){o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(n,!0).forEach((function(t){Object(f.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r,Object(f.a)({},e,t)))}};return s.a.createElement("div",{className:t.root},s.a.createElement(O.a,{anchor:"top",open:r.top,onClose:c("top",!1)},(e="top",s.a.createElement("div",{className:t.fullList,role:"presentation",onClick:c(e,!1)},s.a.createElement(w.a,null,s.a.createElement(x.a,{button:!0,key:"\u9996\u9801"},s.a.createElement(k.a,null,s.a.createElement(S.a,null)),s.a.createElement(P.a,{primary:"\u9996\u9801"})),s.a.createElement(x.a,{button:!0,key:"\u500b\u4eba\u8cc7\u6599"},s.a.createElement(k.a,null,s.a.createElement(I.a,null)),s.a.createElement(P.a,{primary:"\u500b\u4eba\u8cc7\u6599"})))))),s.a.createElement(v.a,{position:"static"},s.a.createElement(b.a,null,s.a.createElement(E.a,{onClick:c("top",!0),edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},s.a.createElement(j.a,null)),s.a.createElement(h.a,{variant:"h6",className:t.title},"\u6b61\u8fce\u4f86\u5230Beyond Toy!"),s.a.createElement(y.a,{color:"inherit"},"Login"))))}var B=n(125),M=n(47),T=n.n(M),L=n(126),A=n(120),U=n(89),_=n(13),z=Object(m.a)((function(e){return{fab:{margin:e.spacing(1),left:"80vw",top:"80vh"},extendedIcon:{marginRight:e.spacing(1)},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),G=function(e){return{detect:function(t){var n=_.h((function(){return _.a.fromPixels(t).expandDims(0)})),a=n.shape[1],r=n.shape[2];return e.executeAsync(n).then((function(e){var t=e[0].dataSync(),o=e[1].dataSync();n.dispose(),_.b(e);var c=function(e,t,n){for(var a=[],r=[],o=0;o<t;o++){for(var c=Number.MIN_VALUE,i=-1,l=0;l<n;l++)e[o*n+l]>c&&(c=e[o*n+l],i=l);a[o]=c,r[o]=i}return[a,r]}(t,e[0].shape[1],e[0].shape[2]),i=Object(p.a)(c,2),l=i[0],s=i[1],u=_.c();_.f("cpu");var d=_.h((function(){var t=_.g(o,[e[1].shape[1],e[1].shape[3]]);return _.d.nonMaxSuppression(t,l,20,.5,.5)})),f=d.dataSync();return d.dispose(),_.f(u),function(e,t,n,a,r,o){for(var c=r.length,i=[],l=0;l<c;l++){for(var s=[],u=0;u<4;u++)s[u]=n[4*r[l]+u];var d=s[0]*t,f=s[1]*e,p=s[2]*t,m=s[3]*e;s[0]=f,s[1]=d,s[2]=m-f,s[3]=p-d,i.push({bbox:s,class:o[r[l]],score:a[r[l]]})}return i}(r,a,o,l,f,s)}))}}},J=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).videoRef=s.a.createRef(),n.canvasRef=s.a.createRef(),n.empty=s.a.createRef(),n.detectFrame=function(e,t,a){G(t).detect(e).then((function(r){n.renderPredictions(r,a),requestAnimationFrame((function(){n.detectFrame(e,t,a)})),n.setState((function(e){return{note:{predictions:r}}}))}))},n.renderPredictions=function(e,t){var a=n.canvasRef.current.getContext("2d");a.clearRect(0,0,a.canvas.width,a.canvas.height);var r="16px sans-serif";a.font=r,a.textBaseline="top",e.forEach((function(e){var n=e.bbox[0],o=e.bbox[1],c=e.bbox[2],i=e.bbox[3],l=t[parseInt(e.class)];a.strokeStyle="#00FFFF",a.lineWidth=4,a.strokeRect(n,o,c,i),a.fillStyle="#00FFFF";var s=a.measureText(l).width,u=parseInt(r,10);a.fillRect(n,o,s+4,u+4)})),e.forEach((function(e){var n=e.bbox[0],r=e.bbox[1],o=t[parseInt(e.class)];a.fillStyle="#000000",a.fillText(o,n,r)}))},n.getPrediction=function(){var e=n.state.note,t=[];n.setState((function(t){return{storage:e}})),n.state.note.predictions.forEach((function(e){0===parseInt(e.class)?t.push("\u5168\u97f3\u7b26"):1===parseInt(e.class)?t.push("\u516b\u5206\u97f3\u7b26"):2===parseInt(e.class)?t.push("\u56db\u5206\u97f3\u7b26"):3===parseInt(e.class)?t.push("\u5341\u516d\u5206\u97f3\u7b26"):4===parseInt(e.class)&&t.push("\u4e8c\u5206\u97f3\u7b26")})),t.reverse(),setTimeout((function(){console.log(t),alert("\u60a8\u8f38\u5165\u7684\u662f"+t+"?")}),1e3)},n.state={note:[],storage:[]},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var t=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then((function(t){return window.stream=t,e.videoRef.current.srcObject=t,new Promise((function(t,n){e.videoRef.current.onloadedmetadata=function(){t()}}))})),n=_.e("/beyondtoy/model_web/model.json"),a=fetch("/beyondtoy/model_web/labels.json").then((function(e){return e.json()}));Promise.all([n,a,t]).then((function(t){var n=Object(p.a)(t,2),a=n[0],r=n[1];e.detectFrame(e.videoRef.current,a,r)})).catch((function(e){console.error(e)}))}}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("video",{className:"size",autoPlay:!0,playsInline:!0,muted:!0,ref:this.videoRef,width:"600",height:"500"}),s.a.createElement("canvas",{className:"size",ref:this.canvasRef,width:"600",height:"500"}),s.a.createElement(B.a,{onClick:this.getPrediction,variant:"extended","aria-label":"delete"},s.a.createElement(T.a,null),"\u78ba\u5b9a\u62cd\u651d"))}}]),t}(s.a.Component);function q(){var e=z(),t=s.a.useState(!1),n=Object(p.a)(t,2),a=n[0],r=n[1];return s.a.createElement("div",null,s.a.createElement(B.a,{onClick:function(){r(!0)},color:"primary","aria-label":"add",className:e.fab},s.a.createElement(T.a,null)),s.a.createElement(L.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:e.modal,open:a,onClose:function(){r(!1)},closeAfterTransition:!0,BackdropComponent:A.a,BackdropProps:{timeout:500}},s.a.createElement(U.a,{in:a},s.a.createElement("div",{className:e.paper},s.a.createElement(J,null)))))}var V=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={IDnow:"0"},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.createElement("script");t.src="http://dive.nutn.edu.tw:8080/Experiment/js/dive.linker.js",t.async=!0,t.onload=function(){return e.scriptLoaded()},document.head.appendChild(t)}},{key:"scriptLoaded",value:function(){console.log("Complete!");var e=new(0,window.DiveLinker)("dive");setInterval((function(){e.getAttr()}),1e3)}},{key:"renderSwitch",value:function(e){switch(e){case"0wrong":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7839";case"0":case"1":case"2":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7827";default:return}}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("iframe",{title:"Dive",id:"Diving",src:this.renderSwitch(this.state.link),name:"dive"}))}}]),t}(s.a.Component),W=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(N,null),s.a.createElement(V,null),s.a.createElement(q,null))}}]),t}(s.a.Component);d.a.render(s.a.createElement(W,null),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.3f2207de.chunk.js.map