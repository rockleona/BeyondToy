(window["webpackJsonpbeyond-toy"]=window["webpackJsonpbeyond-toy"]||[]).push([[0],{44:function(e,t,n){},63:function(e,t,n){e.exports=n(86)},80:function(e,t){},81:function(e,t){},82:function(e,t){},83:function(e,t){},84:function(e,t){},85:function(e,t){},86:function(e,t,n){"use strict";n.r(t);var a=n(34),r=n(35),o=n(38),c=n(36),i=n(39),l=n(1),s=n.n(l),u=n(9),f=n.n(u),d=(n(44),n(46)),m=n(28),p=n(114),b=n(121),v=n(122),h=n(40),y=n(124),g=n(123),E=n(55),O=n.n(E),j=n(127),w=n(115),x=n(117),k=n(118),P=n(119),R=n(53),S=n.n(R),C=n(54),F=n.n(C);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var D=Object(p.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function I(){var e,t=D(),n=s.a.useState({top:!1,link:"11111"}),a=Object(m.a)(n,2),r=a[0],o=a[1],c=function(e,t){return function(n){o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r,Object(d.a)({},e,t)))}};return s.a.createElement("div",{className:t.root},s.a.createElement(j.a,{anchor:"top",open:r.top,onClose:c("top",!1)},(e="top",s.a.createElement("div",{className:t.fullList,role:"presentation",onClick:c(e,!1)},s.a.createElement(w.a,null,s.a.createElement(x.a,{button:!0,key:"\u9996\u9801"},s.a.createElement(k.a,null,s.a.createElement(S.a,null)),s.a.createElement(P.a,{primary:"\u9996\u9801"})),s.a.createElement(x.a,{button:!0,key:"\u500b\u4eba\u8cc7\u6599"},s.a.createElement(k.a,null,s.a.createElement(F.a,null)),s.a.createElement(P.a,{primary:"\u500b\u4eba\u8cc7\u6599"})))))),s.a.createElement(b.a,{position:"static"},s.a.createElement(v.a,null,s.a.createElement(g.a,{onClick:c("top",!0),edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},s.a.createElement(O.a,null)),s.a.createElement(h.a,{variant:"h6",className:t.title},"\u6b61\u8fce\u4f86\u5230Beyond Toy! ",r.link),s.a.createElement(y.a,{color:"inherit"},"Login"))))}var B=n(125),M=n(47),T=n.n(M),A=n(126),L=n(120),U=n(89),_=n(13),z=Object(p.a)((function(e){return{fab:{margin:e.spacing(1),left:"80vw",top:"80vh"},extendedIcon:{marginRight:e.spacing(1)},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),G=function(e){return{detect:function(t){var n=_.h((function(){return _.a.fromPixels(t).expandDims(0)})),a=n.shape[1],r=n.shape[2];return e.executeAsync(n).then((function(e){var t=e[0].dataSync(),o=e[1].dataSync();n.dispose(),_.b(e);var c=function(e,t,n){for(var a=[],r=[],o=0;o<t;o++){for(var c=Number.MIN_VALUE,i=-1,l=0;l<n;l++)e[o*n+l]>c&&(c=e[o*n+l],i=l);a[o]=c,r[o]=i}return[a,r]}(t,e[0].shape[1],e[0].shape[2]),i=Object(m.a)(c,2),l=i[0],s=i[1],u=_.c();_.f("cpu");var f=_.h((function(){var t=_.g(o,[e[1].shape[1],e[1].shape[3]]);return _.d.nonMaxSuppression(t,l,20,.5,.5)})),d=f.dataSync();return f.dispose(),_.f(u),function(e,t,n,a,r,o){for(var c=r.length,i=[],l=0;l<c;l++){for(var s=[],u=0;u<4;u++)s[u]=n[4*r[l]+u];var f=s[0]*t,d=s[1]*e,m=s[2]*t,p=s[3]*e;s[0]=d,s[1]=f,s[2]=p-d,s[3]=m-f,i.push({bbox:s,class:o[r[l]],score:a[r[l]]})}return i}(r,a,o,l,d,s)}))}}},J=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).videoRef=s.a.createRef(),n.canvasRef=s.a.createRef(),n.empty=s.a.createRef(),n.detectFrame=function(e,t,a){G(t).detect(e).then((function(r){n.renderPredictions(r,a),requestAnimationFrame((function(){n.detectFrame(e,t,a)})),n.setState((function(e){return{note:{predictions:r}}}))}))},n.renderPredictions=function(e,t){var a=n.canvasRef.current.getContext("2d");a.clearRect(0,0,a.canvas.width,a.canvas.height);var r="16px sans-serif";a.font=r,a.textBaseline="top",e.forEach((function(e){var n=e.bbox[0],o=e.bbox[1],c=e.bbox[2],i=e.bbox[3],l=t[parseInt(e.class)];a.strokeStyle="#00FFFF",a.lineWidth=4,a.strokeRect(n,o,c,i),a.fillStyle="#00FFFF";var s=a.measureText(l).width,u=parseInt(r,10);a.fillRect(n,o,s+4,u+4)})),e.forEach((function(e){var n=e.bbox[0],r=e.bbox[1],o=t[parseInt(e.class)];a.fillStyle="#000000",a.fillText(o,n,r)}))},n.getPrediction=function(){var e=n.state.note;n.setState((function(t){return{storage:e}})),setTimeout((function(){console.log(n.state.storage)}),500)},n.state={note:[],storage:[]},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var t=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then((function(t){return window.stream=t,e.videoRef.current.srcObject=t,new Promise((function(t,n){e.videoRef.current.onloadedmetadata=function(){t()}}))})),n=_.e("/beyondtoy/model_web/model.json"),a=fetch("/beyondtoy/model_web/labels.json").then((function(e){return e.json()}));Promise.all([n,a,t]).then((function(t){var n=Object(m.a)(t,2),a=n[0],r=n[1];e.detectFrame(e.videoRef.current,a,r)})).catch((function(e){console.error(e)}))}}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("video",{className:"size",autoPlay:!0,playsInline:!0,muted:!0,ref:this.videoRef,width:"600",height:"500"}),s.a.createElement("canvas",{className:"size",ref:this.canvasRef,width:"600",height:"500"}),s.a.createElement(B.a,{onClick:this.getPrediction,variant:"extended","aria-label":"delete"},s.a.createElement(T.a,null),"\u78ba\u5b9a\u62cd\u651d"))}}]),t}(s.a.Component);function q(){var e=z(),t=s.a.useState(!1),n=Object(m.a)(t,2),a=n[0],r=n[1];return s.a.createElement("div",null,s.a.createElement(B.a,{onClick:function(){r(!0)},color:"primary","aria-label":"add",className:e.fab},s.a.createElement(T.a,null)),s.a.createElement(A.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:e.modal,open:a,onClose:function(){r(!1)},closeAfterTransition:!0,BackdropComponent:L.a,BackdropProps:{timeout:500}},s.a.createElement(U.a,{in:a},s.a.createElement("div",{className:e.paper},s.a.createElement(J,null)))))}var V=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(I,null),s.a.createElement(q,null))}}]),t}(s.a.Component);f.a.render(s.a.createElement(V,null),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.0486c258.chunk.js.map