(window["webpackJsonpbeyond-toy"]=window["webpackJsonpbeyond-toy"]||[]).push([[0],{36:function(e,t,n){},64:function(e,t,n){e.exports=n(87)},81:function(e,t){},82:function(e,t){},83:function(e,t){},84:function(e,t){},85:function(e,t){},86:function(e,t){},87:function(e,t,n){"use strict";n.r(t);var a=n(23),r=n(24),i=n(29),o=n(25),c=n(30),s=n(1),l=n.n(s),u=n(9),d=n.n(u),p=(n(36),n(46)),f=n(33),m=n(114),h=n(121),v=n(122),b=n(41),E=n(124),g=n(123),y=n(55),O=n.n(y),j=n(127),w=n(115),x=n(117),k=n(118),I=n(119),P=n(53),S=n.n(P),R=n(54),D=n.n(R);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var F=Object(m.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function N(){var e,t=F(),n=l.a.useState({top:!1,link:"11111"}),a=Object(f.a)(n,2),r=a[0],i=a[1],o=function(e,t){return function(n){i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r,Object(p.a)({},e,t)))}};return l.a.createElement("div",{className:t.root},l.a.createElement(j.a,{anchor:"top",open:r.top,onClose:o("top",!1)},(e="top",l.a.createElement("div",{className:t.fullList,role:"presentation",onClick:o(e,!1)},l.a.createElement(w.a,null,l.a.createElement(x.a,{button:!0,key:"\u9996\u9801"},l.a.createElement(k.a,null,l.a.createElement(S.a,null)),l.a.createElement(I.a,{primary:"\u9996\u9801"})),l.a.createElement(x.a,{button:!0,key:"\u500b\u4eba\u8cc7\u6599"},l.a.createElement(k.a,null,l.a.createElement(D.a,null)),l.a.createElement(I.a,{primary:"\u500b\u4eba\u8cc7\u6599"})))))),l.a.createElement(h.a,{position:"static"},l.a.createElement(v.a,null,l.a.createElement(g.a,{onClick:o("top",!0),edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},l.a.createElement(O.a,null)),l.a.createElement(b.a,{variant:"h6",className:t.title},"\u6b61\u8fce\u4f86\u5230Beyond Toy!"),l.a.createElement(E.a,{color:"inherit"},"Login"))))}var T=n(125),G=n(47),B=n.n(G),M=n(126),A=n(120),L=n(90),U=n(13),_=Object(m.a)((function(e){return{fab:{margin:e.spacing(1),left:"80vw",top:"75vh"},extendedIcon:{marginRight:e.spacing(1)},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),z=function(e){return{detect:function(t){var n=U.h((function(){return U.a.fromPixels(t).expandDims(0)})),a=n.shape[1],r=n.shape[2];return e.executeAsync(n).then((function(e){var t=e[0].dataSync(),i=e[1].dataSync();n.dispose(),U.b(e);var o=function(e,t,n){for(var a=[],r=[],i=0;i<t;i++){for(var o=Number.MIN_VALUE,c=-1,s=0;s<n;s++)e[i*n+s]>o&&(o=e[i*n+s],c=s);a[i]=o,r[i]=c}return[a,r]}(t,e[0].shape[1],e[0].shape[2]),c=Object(f.a)(o,2),s=c[0],l=c[1],u=U.c();U.f("cpu");var d=U.h((function(){var t=U.g(i,[e[1].shape[1],e[1].shape[3]]);return U.d.nonMaxSuppression(t,s,20,.5,.5)})),p=d.dataSync();return d.dispose(),U.f(u),function(e,t,n,a,r,i){for(var o=r.length,c=[],s=0;s<o;s++){for(var l=[],u=0;u<4;u++)l[u]=n[4*r[s]+u];var d=l[0]*t,p=l[1]*e,f=l[2]*t,m=l[3]*e;l[0]=p,l[1]=d,l[2]=m-p,l[3]=f-d,c.push({bbox:l,class:i[r[s]],score:a[r[s]]})}return c}(r,a,i,s,p,l)}))}}},J=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).videoRef=l.a.createRef(),n.canvasRef=l.a.createRef(),n.empty=l.a.createRef(),n.detectFrame=function(e,t,a){z(t).detect(e).then((function(r){n.renderPredictions(r,a),requestAnimationFrame((function(){n.detectFrame(e,t,a)})),n.setState((function(e){return{note:{predictions:r}}}))}))},n.renderPredictions=function(e,t){var a=n.canvasRef.current.getContext("2d");a.clearRect(0,0,a.canvas.width,a.canvas.height);var r="16px sans-serif";a.font=r,a.textBaseline="top",e.forEach((function(e){var n=e.bbox[0],i=e.bbox[1],o=e.bbox[2],c=e.bbox[3],s=t[parseInt(e.class)];a.strokeStyle="#00FFFF",a.lineWidth=4,a.strokeRect(n,i,o,c),a.fillStyle="#00FFFF";var l=a.measureText(s).width,u=parseInt(r,10);a.fillRect(n,i,l+4,u+4)})),e.forEach((function(e){var n=e.bbox[0],r=e.bbox[1],i=t[parseInt(e.class)];a.fillStyle="#000000",a.fillText(i,n,r)}))},n.getPrediction=function(){var e=n.state.note,t=[];n.setState((function(t){return{storage:e}})),n.state.note.predictions.forEach((function(e){0===parseInt(e.class)?t.push("\u5168\u97f3\u7b26"):1===parseInt(e.class)?t.push("\u516b\u5206\u97f3\u7b26"):2===parseInt(e.class)?t.push("\u56db\u5206\u97f3\u7b26"):3===parseInt(e.class)?t.push("\u5341\u516d\u5206\u97f3\u7b26"):4===parseInt(e.class)&&t.push("\u4e8c\u5206\u97f3\u7b26")})),t.reverse(),setTimeout((function(){console.log(t),alert("\u60a8\u8f38\u5165\u7684\u662f"+t+"?")}),1e3)},n.state={note:[],storage:[]},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var t=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then((function(t){return window.stream=t,e.videoRef.current.srcObject=t,new Promise((function(t,n){e.videoRef.current.onloadedmetadata=function(){t()}}))})),n=U.e("/beyondtoy/model_web/model.json"),a=fetch("/beyondtoy/model_web/labels.json").then((function(e){return e.json()}));Promise.all([n,a,t]).then((function(t){var n=Object(f.a)(t,2),a=n[0],r=n[1];e.detectFrame(e.videoRef.current,a,r)})).catch((function(e){console.error(e)}))}}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("video",{className:"size",autoPlay:!0,playsInline:!0,muted:!0,ref:this.videoRef,width:"600",height:"500"}),l.a.createElement("canvas",{className:"size",ref:this.canvasRef,width:"600",height:"500"}),l.a.createElement(T.a,{onClick:this.getPrediction,variant:"extended","aria-label":"delete"},l.a.createElement(B.a,null),"\u78ba\u5b9a\u62cd\u651d"))}}]),t}(l.a.Component);function q(){var e=_(),t=l.a.useState(!1),n=Object(f.a)(t,2),a=n[0],r=n[1];return l.a.createElement("div",null,l.a.createElement(T.a,{onClick:function(){r(!0)},color:"primary","aria-label":"add",className:e.fab},l.a.createElement(B.a,null)),l.a.createElement(M.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:e.modal,open:a,onClose:function(){r(!1)},closeAfterTransition:!0,BackdropComponent:A.a,BackdropProps:{timeout:500}},l.a.createElement(L.a,{in:a},l.a.createElement("div",{className:e.paper},l.a.createElement(J,null)))))}var V=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={IDnow:"0"},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"renderSwitch",value:function(e){switch(e){case"0wrong":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7839";case"0":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7827";case"1":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7837";case"2":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7846";case"3":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7848";case"4":return"http://dive.nutn.edu.tw:8080/Experiment//kaleTestExperiment5.jsp?eid=7841";default:return}}},{key:"goGO",value:function(e){this.setState((function(t){return{IDnow:e}}))}},{key:"jumpNext",value:function(){var e=this.state.IDnow;"0"===e?this.goGO("0wrong"):"0wrong"===e?this.goGO("1"):"1"===e?this.goGO("2"):"2"===e?this.goGO("3"):"3"===e&&this.goGO("4")}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("iframe",{title:"Dive",id:"Diving",src:this.renderSwitch(this.state.IDnow),name:"dive"}),l.a.createElement(E.a,{id:"next"},"\u9032\u884c\u6aa2\u67e5"))}}]),t}(l.a.Component),W=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(N,null),l.a.createElement(V,null),l.a.createElement(q,null))}}]),t}(l.a.Component);d.a.render(l.a.createElement(W,null),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.4e042737.chunk.js.map